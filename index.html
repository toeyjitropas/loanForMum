<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Loan Calculator</title>
<style>
  /* Add CSS here to style your web app */
</style>
</head>
<body>

<h2>Loan Calculator</h2>

<form id="loanForm">
  <label for="principal">Principal ($):</label>
  <input type="number" id="principal" name="principal"><br><br>
  
  <label for="interest">Annual Interest Rate (%):</label>
  <input type="number" id="interest" name="interest" step="0.01"><br><br>
  
  <label for="years">Loan Term (Years):</label>
  <input type="number" id="years" name="years"><br><br>
  
  <input type="button" value="Calculate" onclick="calculateLoan()">
</form>

<div id="loanSchedule"></div>

<script>
    function calculateLoan() {
  var principal = parseFloat(document.getElementById("principal").value);
  var interestRate = parseFloat(document.getElementById("interest").value) / 100 / 12; // Convert annual rate to monthly and percentage
  var years = parseFloat(document.getElementById("years").value);
  var payments = years * 12; // Total number of payments

  var x = Math.pow(1 + interestRate, payments); // Compound interest factor
  var monthlyPayment = (principal*x*interestRate)/(x-1);

  if (!isNaN(monthlyPayment) && (monthlyPayment != Infinity) && (monthlyPayment > 0)) {
    document.getElementById("loanSchedule").innerHTML = `<h3>Loan Schedule</h3><p>Monthly Payment: THB ${monthlyPayment.toFixed(2)}</p>`;
    var result = "<table><tr><th>Month</th><th>Balance</th><th>Interest</th><th>Principal</th><th>Payment</th></tr>";
    var balance = principal;
    for (var i = 1; i <= payments; i++) {
      var interestPayment = balance * interestRate;
      var principalPayment = monthlyPayment - interestPayment;
      balance -= principalPayment;

      if (balance < 0) {
        balance = 0; // Ensure the balance never goes negative
      }

      result += `<tr><td>${i}</td><td>${balance.toFixed(2)}</td><td>${interestPayment.toFixed(2)}</td><td>${principalPayment.toFixed(2)}</td> <td>${monthlyPayment.toFixed(2)}</td></tr>`;
      if(balance === 0) break; // Stop the loop if the balance is fully paid
    }
    result += "</table>";
    document.getElementById("loanSchedule").innerHTML += result;
  } else {
    alert("Please, enter valid numbers for all fields.");
  }
}


</script>

</body>
</html>
